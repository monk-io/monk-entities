namespace: gcp
service-account:
  defines: entity
  metadata:
    name: ServiceAccount
    version-hash: d87fc5c5f384
  schema:
    project:
      type: string
      description: 'Override the GCP project ID (optional, defaults to environment)'
    name:
      type: string
      description: >-
        Service account ID (will form part of the email address).

        Must be 6-30 characters, start with a letter, and contain only lowercase
        letters,

        numbers, and hyphens.

        The email will be: {name}@{project}.iam.gserviceaccount.com
    display_name:
      type: string
      description: |-
        Human-readable display name for the service account.
        Shown in the Cloud Console. Max 100 characters.
    account_description:
      type: string
      description: |-
        Description of the service account's purpose.
        Max 256 characters.
    roles:
      type: array
      items:
        type: string
      description: |-
        List of IAM roles to grant to this service account at the project level.
        Use predefined roles (e.g., "roles/storage.admin") or custom roles.
    required:
      - name
  state-schema:
    existing:
      type: boolean
      description: Indicates if the resource already existed before this entity managed it
    operation_name:
      type: string
      description: Operation name for tracking long-running operations
    unique_id:
      type: string
      description: Unique ID of the service account (numeric)
    email:
      type: string
      description: |-
        Email address of the service account.
        Format: {name}@{project}.iam.gserviceaccount.com
    name:
      type: string
      description: |-
        Full resource name of the service account.
        Format: projects/{project}/serviceAccounts/{email}
    display_name:
      type: string
      description: Human-readable display name
    disabled:
      type: boolean
      description: Whether the service account is disabled
    oauth2_client_id:
      type: string
      description: OAuth2 client ID for web applications
  lifecycle:
    sync: <<< service-account-sync.js
    get-info: ''
    enable: ''
    disable: ''
  checks:
    readiness:
      period: 5
      initialDelay: 2
      attempts: 10
    liveness:
      period: 300
  requires:
    - monkec/base
    - gcp/gcp-base
    - cli
    - gcp/common
