namespace: gcp
service-account-key:
  defines: entity
  metadata:
    name: ServiceAccountKey
    version-hash: 60073a5fb197
  schema:
    project:
      type: string
      description: 'Override the GCP project ID (optional, defaults to environment)'
    secret:
      type: string
      description: Secret name where the private key will be stored
    service_account_id:
      type: string
      description: Service account unique ID (usually from connection)
    key_type:
      type: string
      description: Key type
      default: TYPE_GOOGLE_CREDENTIALS_FILE
    key_algorithm:
      type: string
      description: Key algorithm
      default: KEY_ALG_RSA_2048
    required:
      - secret
      - service_account_id
  state-schema:
    existing:
      type: boolean
      description: Indicates if the resource already existed before this entity managed it
    operation_name:
      type: string
      description: Operation name for tracking long-running operations
    name:
      type: string
      description: Full resource name of the key
    key_id:
      type: string
      description: Key ID
    key_algorithm:
      type: string
      description: Key algorithm used
    key_type:
      type: string
      description: Key type
    valid_after_time:
      type: string
      description: When the key was created
  lifecycle:
    sync: <<< service-account-key-sync.js
  checks:
    readiness:
      period: 5
      initialDelay: 2
      attempts: 10
    liveness:
      period: 300
  requires:
    - gcp/gcp-base
    - secret
    - cli
    - gcp/common
