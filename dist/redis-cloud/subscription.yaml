namespace: redis-cloud
subscription:
  defines: entity
  metadata:
    name: Subscription
  schema:
    secret_ref:
      type: string
      minLength: 1
      maxLength: 24
    account_key_secret:
      type: string
      minLength: 1
      maxLength: 24
    user_key_secret:
      type: string
      minLength: 1
      maxLength: 24
    subscription_type:
      type: string
      enum:
        - essentials
        - pro
    name:
      type: string
      description: Name of the subscription
    provider:
      type: string
      enum:
        - AWS
        - GCP
        - AZURE
      description: 'Cloud provider for the subscription (AWS, GCP, or AZURE)'
    region:
      type: string
      description: Cloud provider region where the subscription will be created
    redis_flex:
      type: boolean
      description: Whether Redis Flex is enabled for this subscription
    size:
      type: number
      description: Size of the subscription (memory size in GB)
    availability:
      type: string
      enum:
        - No replication
        - Single-zone
        - Multi-zone
      description: Availability configuration for the subscription
    support_data_persistence:
      type: boolean
      description: Whether the subscription supports data persistence
    support_instant_and_daily_backups:
      type: boolean
      description: Whether the subscription supports instant and daily backups
    support_replication:
      type: boolean
      description: Whether the subscription supports replication
    support_clustering:
      type: boolean
      description: Whether the subscription supports clustering
    support_ssl:
      type: boolean
      description: Whether the subscription supports SSL encryption
    payment_method:
      type: string
      enum:
        - credit-card
        - marketplace
      description: Payment method type (credit-card or marketplace)
    payment_method_id:
      type: number
      description: Specific payment method ID if known
    payment_method_type:
      type: string
      description: Type of payment method to auto-select
    required:
      - subscription_type
      - name
      - provider
      - region
      - redis_flex
      - size
      - availability
      - support_data_persistence
      - support_instant_and_daily_backups
      - support_replication
      - support_clustering
      - support_ssl
  lifecycle:
    sync: <<< subscription-sync.js
  checks:
    readiness:
      period: 5
      initialDelay: 2
      attempts: 10
  requires:
    - redis-cloud/base
    - cli
