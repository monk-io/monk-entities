namespace: aws-rds
rds-access-list:
  defines: entity
  metadata:
    name: RDSAccessList
    description: |-
      AWS RDS Access List entity.
      Manages security group ingress rules for RDS database access.
      Controls which CIDR blocks and security groups can connect to the database.

      ## Secrets
      - Reads: none (authenticated via AWS provider)
      - Writes: none

      ## State Fields for Composition
      - `state.existing` - Whether the rules pre-existed

      ## Composing with Other Entities
      Works with:
      - `aws-ec2/security-group` - The security group to modify
      - `aws-rds/instance` - The RDS instance protected by the security group
    version-hash: e96aa6ffe796
  schema:
    region:
      type: string
    security_group_id:
      type: string
    port:
      type: number
    allowed_cidr_blocks:
      type: array
      items:
        type: string
    allowed_security_group_names:
      type: array
      items:
        type: string
    vpc_id:
      type: string
    required:
      - region
      - security_group_id
      - port
  state-schema:
    existing:
      type: boolean
    required:
      - existing
  lifecycle:
    sync: <<< rds-access-list-sync.js
  requires:
    - monkec/base
    - aws-rds/security-group
    - cli
