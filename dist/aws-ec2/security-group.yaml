namespace: aws-ec2
security-group:
  defines: entity
  metadata:
    name: SecurityGroup
    description: |-
      AWS EC2 Security Group entity.
      Creates and manages VPC security groups for network access control.
      Security groups act as virtual firewalls for inbound and outbound traffic.

      ## Secrets
      - Reads: none (authenticated via AWS provider)
      - Writes: none

      ## State Fields for Composition
      - `state.group_id` - Security group ID for resource associations
      - `state.group_name` - Security group name

      ## Composing with Other Entities
      Works with:
      - `aws-ec2/vpc` - The VPC containing this security group
      - `aws-rds/instance` - Assign to database instances
      - `aws-lambda/function` - Assign to Lambda functions in VPC
    version-hash: d4ccad916e47
  schema:
    region:
      type: string
    vpc_id:
      type: string
    group_name:
      type: string
    group_description:
      type: string
    group_id:
      type: string
    ingress:
      type: array
      items:
        type: object
        properties:
          ip_protocol:
            type: string
          from_port:
            type: number
          to_port:
            type: number
          cidr_blocks:
            type: array
            items:
              type: string
          source_security_group_id:
            type: string
        required:
          - ip_protocol
        additionalProperties: false
    egress:
      type: array
      items:
        type: object
        properties:
          ip_protocol:
            type: string
          from_port:
            type: number
          to_port:
            type: number
          cidr_blocks:
            type: array
            items:
              type: string
          source_security_group_id:
            type: string
        required:
          - ip_protocol
        additionalProperties: false
    tags:
      type: object
      additionalProperties:
        type: string
    required:
      - region
      - vpc_id
      - group_name
      - group_description
  state-schema:
    existing:
      type: boolean
    group_id:
      type: string
    group_name:
      type: string
  lifecycle:
    sync: <<< security-group-sync.js
  requires:
    - aws-ec2/base
