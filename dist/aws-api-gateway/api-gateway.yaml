namespace: aws-api-gateway
api-gateway:
  defines: entity
  metadata:
    name: APIGateway
    description: |-
      AWS API Gateway entity.
      Creates and manages Amazon API Gateway HTTP APIs and WebSocket APIs.
      Supports Lambda integrations with automatic route configuration and auto-deploy stages.

      ## Secrets
      - Reads: none (authenticated via AWS provider)
      - Writes: none

      ## State Fields for Composition
      - `state.api_id` - API ID for management operations
      - `state.api_endpoint` - Invoke URL for API requests
      - `state.name` - API name

      ## Composing with Other Entities
      Works with:
      - `aws-lambda/function` - Backend integrations for API routes
      - `aws-cognito/user-pool` - JWT authorizers for authentication
      - `aws-iam/role` - IAM authorization for API access
    version-hash: c881d0b27306
  schema:
    region:
      type: string
    name:
      type: string
    protocol_type:
      type: string
      enum:
        - HTTP
        - WEBSOCKET
    routes: {}
    tags:
      type: object
      additionalProperties:
        type: string
    required:
      - region
      - name
      - protocol_type
  state-schema:
    existing:
      type: boolean
    api_id:
      type: string
    api_endpoint:
      type: string
    name:
      type: string
      description: API name
    protocol_type:
      type: string
      description: Protocol type (HTTP or WEBSOCKET)
  lifecycle:
    sync: <<< api-gateway-sync.js
    sync-routes: ''
    get-endpoint: ''
    list-routes: ''
  checks:
    readiness:
      period: 5
      initialDelay: 2
      attempts: 10
    liveness:
      period: 300
  requires:
    - aws-api-gateway/api-gateway-base
    - monkec/base
    - cli
