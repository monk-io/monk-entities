namespace: aws-dynamo-db-advanced-test

# Table with provisioned billing and composite key
provisioned-table:
  defines: aws-dynamo-db/dynamo-db-table
  region: us-east-1
  table_name: monk-test-provisioned-table
  attribute_definitions:
    - AttributeName: user_id
      AttributeType: S
    - AttributeName: timestamp
      AttributeType: N
  key_schema:
    - AttributeName: user_id
      KeyType: HASH
    - AttributeName: timestamp
      KeyType: RANGE
  billing_mode: PROVISIONED
  provisioned_throughput:
    ReadCapacityUnits: 5
    WriteCapacityUnits: 5
  sse_specification:
    Enabled: true
    SSEType: KMS
  point_in_time_recovery_enabled: true
  tags:
    Environment: test
    Purpose: advanced-integration-testing
    Owner: monk-framework
    BillingMode: provisioned

# Table with Global Secondary Index
gsi-table:
  defines: aws-dynamo-db/dynamo-db-table
  region: us-east-1
  table_name: monk-test-gsi-table
  attribute_definitions:
    - AttributeName: event_id
      AttributeType: S
    - AttributeName: timestamp
      AttributeType: N
    - AttributeName: user_type
      AttributeType: S
  key_schema:
    - AttributeName: event_id
      KeyType: HASH
    - AttributeName: timestamp
      KeyType: RANGE
  billing_mode: PAY_PER_REQUEST
  global_secondary_indexes:
    - IndexName: UserTypeIndex
      KeySchema:
        - AttributeName: user_type
          KeyType: HASH
        - AttributeName: timestamp
          KeyType: RANGE
      Projection:
        ProjectionType: ALL
  stream_specification:
    StreamEnabled: true
    StreamViewType: NEW_AND_OLD_IMAGES
  tags:
    Environment: test
    Purpose: gsi-integration-testing
    Owner: monk-framework
    Features: gsi-streams

stack:
  defines: process-group
  runnable-list:
    - aws-dynamo-db-advanced-test/provisioned-table
    - aws-dynamo-db-advanced-test/gsi-table 