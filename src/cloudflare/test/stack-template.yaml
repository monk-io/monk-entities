namespace: cloudflare-test

zone:
  defines: cloudflare/cloudflare-dns-zone
  name: thisbetterbe.online
  permitted-secrets:
    cloudflare-api-token: true
  services:
    data:
      protocol: custom

record:
  defines: cloudflare/cloudflare-dns-record
  zone_name: <- connection-target("zone") entity-state get-member("name")
  record_type: A
  name: www2
  content: 198.51.100.4
  ttl: 1 # automatic
  proxied: true # toggle orange cloud
  permitted-secrets:
    cloudflare-api-token: true
  connections:
    zone:
      runnable: cloudflare-test/zone
      service: data
  depends:
    wait-for:
      runnables:
        - cloudflare-test/zone
      timeout: 60

stack:
  defines: process-group
  runnable-list:
    - cloudflare-test/zone
    - cloudflare-test/record


