namespace: digitalocean-database-example

# Basic PostgreSQL database cluster
my-postgres-db:
  defines: digitalocean-database/digital-ocean-database
  secret_ref: digitalocean-api-key
  name: my-postgres-cluster
  engine: pg
  version: "16"
  num_nodes: 1
  region: nyc1
  size: db-s-1vcpu-1gb
  tags:
    - environment:production
    - application:my-app
  permitted-secrets:
    digitalocean-api-key: true

# MySQL database cluster with multiple nodes
my-mysql-cluster:
  defines: digitalocean-database/digital-ocean-database
  secret_ref: digitalocean-api-key
  name: my-mysql-cluster
  engine: mysql
  version: "8.0"
  num_nodes: 3
  region: sfo3
  size: db-s-2vcpu-4gb
  tags:
    - environment:production
    - application:ecommerce
  db_config:
    sql_mode: "STRICT_TRANS_TABLES,NO_ZERO_DATE,NO_ZERO_IN_DATE,ERROR_FOR_DIVISION_BY_ZERO"
    default_time_zone: "UTC"
  permitted-secrets:
    digitalocean-api-key: true

# Redis cache cluster
my-redis-cache:
  defines: digitalocean-database/digital-ocean-database
  secret_ref: digitalocean-api-key
  name: my-redis-cache
  engine: redis
  version: "7"
  num_nodes: 1
  region: fra1
  size: db-s-1vcpu-2gb
  tags:
    - environment:production
    - application:cache
  db_config:
    redis_maxmemory_policy: "allkeys-lru"
  permitted-secrets:
    digitalocean-api-key: true

# MongoDB cluster
my-mongodb:
  defines: digitalocean-database/digital-ocean-database
  secret_ref: digitalocean-api-key
  name: my-mongodb-cluster
  engine: mongodb
  version: "7.0"
  num_nodes: 3
  region: lon1
  size: db-s-4vcpu-8gb
  tags:
    - environment:production
    - application:document-store
  permitted-secrets:
    digitalocean-api-key: true
