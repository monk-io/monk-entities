namespace: digitalocean-monitoring-example

# Basic CPU monitoring alert for high CPU usage
monk-cpu-alert:
  defines: digitalocean-monitoring/monitoring
  name: monk-cpu-high-alert
  metric_type: v1/insights/droplet/cpu
  compare: GreaterThan
  value: 80
  window: 10m
  tags:
    - production
    - web-server
  enabled: true
  create_when_missing: true

monk-memory-alert:
  defines: digitalocean-monitoring/monitoring
  name: monk-memory-high-alert
  metric_type: v1/insights/droplet/memory_utilization_percent
  compare: GreaterThan
  value: 90
  window: 5m
  tags:
    - production
    - database
  slack_channels:
    - channel: "#alerts"
      url: "https://hooks.slack.com/services/YOUR/SLACK/WEBHOOK"
  enabled: true
  create_when_missing: true

# Disk utilization monitoring
monk-disk-alert:
  defines: digitalocean-monitoring/monitoring
  name: monk-disk-full-alert
  metric_type: v1/insights/droplet/disk_utilization_percent
  compare: GreaterThan
  value: 85
  window: 30m
  enabled: true
  create_when_missing: true

# Load average monitoring
monk-load-alert:
  defines: digitalocean-monitoring/monitoring
  name: monk-load-high-alert
  metric_type: v1/insights/droplet/load_5
  compare: GreaterThan
  value: 2.0
  window: 10m
  tags:
    - production
  enabled: true
  create_when_missing: true

# Network bandwidth monitoring
monk-bandwidth-alert:
  defines: digitalocean-monitoring/monitoring
  name: monk-bandwidth-high-alert
  metric_type: v1/insights/droplet/public_outbound_bandwidth
  compare: GreaterThan
  value: 1000000000  # 1GB in bytes
  window: 1h
  enabled: true
  create_when_missing: true

# Disk I/O monitoring
monk-disk-io-alert:
  defines: digitalocean-monitoring/monitoring
  name: monk-disk-write-alert
  metric_type: v1/insights/droplet/disk_write
  compare: GreaterThan
  value: 50000000  # 50MB/s in bytes
  window: 10m
  tags:
    - database
    - high-io
  enabled: true
  create_when_missing: true

# Load Balancer monitoring
monk-lb-cpu-alert:
  defines: digitalocean-monitoring/monitoring
  name: monk-lb-cpu-high-alert
  metric_type: v1/insights/lbaas/avg_cpu_utilization_percent
  compare: GreaterThan
  value: 80
  window: 10m
  entities:
    - "your-lb-id"  # Replace with actual LB ID
  enabled: true
  create_when_missing: true

# Load Balancer HTTP errors
monk-lb-5xx-alert:
  defines: digitalocean-monitoring/monitoring
  name: monk-lb-5xx-errors-alert
  metric_type: v1/insights/lbaas/increase_in_http_error_rate_percentage_5xx
  compare: GreaterThan
  value: 5  # 5% error rate increase
  window: 5m
  entities:
    - "your-lb-id"
  enabled: true
  create_when_missing: true

# Database monitoring
monk-db-cpu-alert:
  defines: digitalocean-monitoring/monitoring
  name: monk-db-cpu-alerts
  metric_type: v1/dbaas/alerts/cpu_alerts
  compare: GreaterThan
  value: 5  # 5 CPU alerts
  window: 10m
  entities:
    - "your-db-id"  # Replace with actual DB ID
  enabled: true
  create_when_missing: true

# Droplet autoscale monitoring
monk-autoscale-instances-alert:
  defines: digitalocean-monitoring/monitoring
  name: monk-autoscale-instances-alert
  metric_type: v1/droplet/autoscale_alerts/current_instances
  compare: GreaterThan
  value: 10  # Alert when more than 10 instances
  window: 5m
  tags:
    - autoscale
    - production
  enabled: true
  create_when_missing: true
