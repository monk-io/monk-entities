namespace: aws-rds-test

# Basic test stack for AWS RDS
stack:
  defines: process-group
  runnable-list:
    - aws-rds-test/test-mysql-instance
    - aws-rds-test/test-postgres-instance

test-mysql-instance:
  defines: aws-rds/rds-instance
  region: us-east-1
  db_instance_identifier: monkec-test-mysql-db
  db_instance_class: db.t3.micro
  engine: mysql
  engine_version: "8.0"
  master_username: testuser
  password_secret_ref: test-mysql-db-password
  allocated_storage: 20
  port: 3306
  storage_type: gp2
  auto_minor_version_upgrade: true
  backup_retention_period: 7
  preferred_backup_window: "05:00-06:00"
  preferred_maintenance_window: "sun:06:00-sun:07:00"
  publicly_accessible: false
  multi_az: false
  deletion_protection: false
  skip_final_snapshot: true
  tags:
    Environment: test
    Application: monkec-test
    ManagedBy: monk
    
test-postgres-instance:
  defines: aws-rds/rds-instance
  region: us-east-1
  db_instance_identifier: monkec-test-postgres-db
  db_instance_class: db.t3.micro
  engine: postgres
  engine_version: "15"
  master_username: testuser
  password_secret_ref: test-postgres-db-password
  allocated_storage: 20
  port: 5432
  storage_type: gp2
  auto_minor_version_upgrade: true
  backup_retention_period: 7
  preferred_backup_window: "05:00-06:00"
  preferred_maintenance_window: "sun:06:00-sun:07:00"
  publicly_accessible: false
  multi_az: false
  deletion_protection: false
  skip_final_snapshot: true
  tags:
    Environment: test
    Application: monkec-test
    ManagedBy: monk 