namespace: poc

# Cloud func uses v2 version of funcs, which requires you to enable following API:
# Artifact Registry, Cloud Build, Cloud Run,
cloudfunc:
  defines: entity
  schema:
    required: [ "name", "project", "location", "build", "service" ]
    name:
      type: string
    project:
      type: string
    location:
      type: string
    source:
      type: object
      properties:
        bucket:
          type: string
        object:
          type: string
    build:
      type: object
      properties:
        runtime:
          type: string
        entrypoint:
          type: string
    service:
      type: object
      properties:
        max-instance-count:
          type: integer
        available-memory:
          type: string
        timeout-seconds:
          type: integer
  lifecycle:
    sync: <<< cloudfunc-sync.js
    generate-upload: ""
    patch: ""

myfunc:
  defines: poc/cloudfunc
  name: date
  project: your-firebase-project
  location: us-east1
  # source can be filled after you upload function files
  # use `monk run` with empty source to generate upload url and fill bucket/object parameters
#  source:
#    bucket: gcf-v2-uploads-548884607057-us-east1
#    object: 1f108c38-cd01-496a-a0f0-dd2165acb430.zip
  build:
    runtime: nodejs16
    entrypoint: date
  service:
    max-instance-count: 1
    available-memory: 256M
    timeout-seconds: 60
